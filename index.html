<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üéÅ Sorpresa Especial</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <style>
    :root{
      --bg1:#0f0c29; --bg2:#302b63; --bg3:#24243e;
      --accent:#ff6b9a; --accent2:#b388ff; --accent3:#ffd6e7;
      --text:#f7f7fb; --muted:#cfcfe6; --glass: rgba(255,255,255,.08);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{ font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; color:var(--text); background:#0b0b16; overflow:hidden; }
    .screen{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding:clamp(16px,3vw,32px); }
    .bg{ position:absolute; inset:-10%; filter: blur(70px) saturate(1.1); opacity:.6; z-index:0; pointer-events:none; }
    .bg::before, .bg::after{
      content:""; position:absolute; inset:0; background: radial-gradient(60% 60% at 20% 30%, #ff7aa2 0%, transparent 55%),
                                           radial-gradient(55% 55% at 80% 20%, #8aa8ff 0%, transparent 50%),
                                           radial-gradient(45% 55% at 50% 100%, #ffc4a3 0%, transparent 60%);
      animation: float 20s ease-in-out infinite alternate;
    }
    @keyframes float{ from{ transform: translateY(-20px) scale(1); } to{ transform: translateY(30px) scale(1.05);} }
    .card{ position:relative; z-index:1; width:min(520px, 94vw); padding:32px 24px; border-radius:24px; background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06)); border:1px solid rgba(255,255,255,.18); box-shadow: 0 20px 50px rgba(0,0,0,.35); backdrop-filter: blur(12px);
    }
    .title{ font-family:"Great Vibes", cursive; font-size: clamp(40px, 9vw, 72px); line-height:1; margin:0 0 6px; text-shadow: 0 2px 12px rgba(0,0,0,.4); }
    .subtitle{ margin:0 0 22px; color:var(--muted); font-weight:400; }
    .input{ width:100%; padding:14px 16px; border-radius:14px; border:1px solid rgba(255,255,255,.25); background:rgba(0,0,0,.25); color:var(--text); font-size:16px; outline:none; transition:.2s; }
    .input:focus{ border-color:var(--accent); box-shadow:0 0 0 6px rgba(255,107,154,.18); }
    .btn{ width:100%; margin-top:14px; padding:14px 16px; border-radius:16px; border:none; color:#0b0b16; font-weight:700; font-size:16px; cursor:pointer; background:linear-gradient(90deg, #ffd1e6, #ff7aa2, #b388ff); transition: transform .1s ease, box-shadow .2s ease; box-shadow: 0 10px 24px rgba(255,122,162,.28);
    }
    .btn:active{ transform: translateY(1px); box-shadow: 0 6px 16px rgba(255,122,162,.22); }
    .hint{ margin-top:10px; font-size:12px; color:#e9e9ff; opacity:.8; text-align:center; }
    #login{ background: radial-gradient(80% 80% at 50% 0%, var(--bg2), transparent 70%), radial-gradient(100% 100% at 50% 100%, var(--bg1), var(--bg3)); }
    #frases, #final{ background:#0b0b16; }
    .center-col{ display:flex; flex-direction:column; align-items:center; text-align:center; gap:14px; }
    .phrase{ font-family:"Great Vibes", cursive; font-size: clamp(34px, 7.6vw, 62px); line-height:1.15; margin:0; text-shadow: 0 6px 26px rgba(0,0,0,.6); opacity:0; transform: translateY(10px) scale(.98); animation: show 1s ease forwards; }
    @keyframes show{ to{ opacity:1; transform: translateY(0) scale(1);} }
    .timer{ font-size:14px; letter-spacing:.12em; color:#e5e5ff; opacity:.85; margin-top:6px; }
    .romantic-bg{ position:absolute; inset:0; z-index:0; pointer-events:none; }
    .romantic-bg .layer{ position:absolute; inset:0; opacity:.55; animation: hue 16s linear infinite; filter: blur(10px) saturate(1.1); }
    .romantic-bg .g1{ background: radial-gradient(120% 90% at 0% 0%, #ffd1e6 0%, transparent 60%), radial-gradient(100% 100% at 100% 50%, #9fc5ff 0%, transparent 50%), radial-gradient(120% 90% at 50% 100%, #ffc4a3 0%, transparent 60%);} 
    .romantic-bg .g2{ background: radial-gradient(100% 80% at 20% 80%, #ffb3c7 0%, transparent 60%), radial-gradient(90% 90% at 80% 20%, #c6b8ff 0%, transparent 60%), radial-gradient(110% 100% at 50% 50%, #ffe7a3 0%, transparent 65%);} 
    @keyframes hue{ 0%{filter:hue-rotate(0deg) saturate(1.05);} 100%{filter:hue-rotate(360deg) saturate(1.05);} }
    .big-message{ font-family:"Great Vibes", cursive; font-size: clamp(44px, 10vw, 92px); margin:0; text-align:center; line-height:1.05; text-shadow: 0 10px 40px rgba(0,0,0,.55); }
    .sub{ margin-top:10px; color:#fff; opacity:.92; font-size: clamp(14px, 2.6vw, 18px); }
    .petal {
      position: fixed;
      top: -10vh;
      width: 25px; 
      height: auto;
      pointer-events: none;
      animation: fall var(--dur) linear var(--delay) infinite;
      transform-origin: center center;
      filter: drop-shadow(0 3px 3px rgba(0,0,0,0.2));
      will-change: transform;
    }
    @keyframes fall{
      0%{ transform: translate3d(var(--x-start), -10vh, 0) rotate(0deg) scale(var(--scale)); }
      100%{ transform: translate3d(var(--x-end), 110vh, 0) rotate(360deg) scale(var(--scale)); }
    }
    .overlay{ position:absolute; inset:0; background: radial-gradient(120% 100% at 50% 100%, rgba(255,255,255,.06), transparent 60%); z-index:0;}
    .hidden{ display:none !important; }
  </style>
</head>
<body>
  <section id="login" class="screen">
    <div class="bg"></div>
    <div class="card center-col">
      <h1 class="title">Bienvenida ‚ú®</h1>
      <p class="subtitle">Ingresa la contrase√±a para abrir tu sorpresa</p>
      <input id="pass" class="input" type="password" inputmode="numeric" placeholder="Contrase√±a" autocomplete="off" />
      <button id="go" class="btn">Entrar</button>
      <p class="hint">(La contrase√±a es <strong>12</strong>)</p>
    </div>
  </section>
  <section id="frases" class="screen hidden">
    <div class="romantic-bg">
      <div class="layer g1"></div>
      <div class="layer g2" style="animation-delay: -8s"></div>
    </div>
    <div class="overlay"></div>
    <div class="center-col" style="z-index:1; max-width:min(900px,94vw);">
      <h2 id="phrase" class="phrase">...</h2>
      <div class="timer" id="count">00:36</div>
    </div>
  </section>
  <section id="final" class="screen hidden">
    <div class="center-col" style="z-index:1; gap:10px; padding: 0 10px;">
      <h2 class="big-message">¬°Feliz cumplea√±os, se√±orita! üéÇ‚ú®</h2>
      <p class="sub">Que este nuevo a√±o te regale motivos para sonre√≠r, amor bonito y sue√±os cumplidos.</p>
    </div>
  </section>
  <audio id="musicLogin" src="assets/musica_login.mp3" preload="auto" loop></audio>
  <audio id="musicFrases" src="assets/musica_frases.mp3" preload="auto"></audio>
  <audio id="musicFinal" src="assets/musica_final.mp3" preload="auto"></audio>

  <script>
    const $ = (sel)=>document.querySelector(sel);
    const show = (id)=>{ ['#login','#frases','#final'].forEach(s=>$(s).classList.add('hidden')); $(id).classList.remove('hidden'); };
    function tryPlay(audio){ if(!audio) return; audio.currentTime = 0; const p = audio.play(); if(p && p.catch){ p.catch(()=>{}); } }
    function stopAll(){ [$('#musicLogin'),$('#musicFrases'),$('#musicFinal')].forEach(a=>{ if(a){ a.pause(); a.currentTime=0; } }); }
    const passInput = $('#pass');
    const goBtn = $('#go');
    const musicLogin = $('#musicLogin');
    const musicFrases = $('#musicFrases');
    const musicFinal = $('#musicFinal');

    const petalImages = [
      'assets/petalo1.png',
      'assets/petalo2.png',
      'assets/petalo3.png'
    ];

    // P√©talos en cada interfaz desde inicio
    spawnPetals(30);

    document.addEventListener('click',()=>{
      tryPlay(musicLogin);
    }, { once:true });

    function enter(){
      if(passInput.value.trim() === '12'){
        stopAll();
        show('#frases');
        startPhrasesStage();
      } else {
        passInput.focus();
        passInput.classList.add('shake');
        setTimeout(()=>passInput.classList.remove('shake'), 500);
      }
    }
    goBtn.addEventListener('click', enter);
    passInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') enter(); });

    const totalSeconds = 36;
    const frases = [
      'Tu sonrisa ilumina cualquier d√≠a ‚ú®',
      'Eres magia en forma de persona ‚ú®',
      'Gracias por existir tan bonito üíó',
      'Contigo, todo se siente hogar üè°',
      'Que tus sue√±os te alcancen üí´',
      'Hoy celebramos tu luz üïØÔ∏è'
    ];
    let phraseIdx = 0;
    function pickRomanticGradient(){
      const palettes = [
        ['#ffd1e6','#ff7aa2','#b388ff'],
        ['#ffe0f0','#ff9ec7','#a3c8ff'],
        ['#fff0d6','#ffc2d1','#c6b8ff'],
        ['#ffd9e8','#ffb3c7','#b9a7ff'],
      ];
      const p = palettes[Math.floor(Math.random()*palettes.length)];
      document.body.style.background = `linear-gradient(180deg, ${p[0]}, ${p[1]}, ${p[2]})`;
    }
    function startPhrasesStage(){
      tryPlay(musicFrases);
      const phraseEl = $('#phrase');
      const countEl = $('#count');
      let t = totalSeconds;
      const perPhrase = totalSeconds / frases.length;
      pickRomanticGradient();
      function tick(){
        const mm = String(Math.floor(t/60)).padStart(2,'0');
        const ss = String(Math.floor(t%60)).padStart(2,'0');
        countEl.textContent = `${mm}:${ss}`;
        if(t <= 0){
          stopAll();
          show('#final');
          startFinalStage();
          return;
        }
        t -= 1;
      }
      function showPhrase(){
        phraseEl.style.opacity = 0;
        phraseEl.style.transform = 'translateY(10px) scale(.98)';
        phraseEl.textContent = frases[phraseIdx % frases.length];
        phraseIdx++;
        requestAnimationFrame(()=>{
          phraseEl.style.transition = 'opacity .8s ease, transform .8s ease';
          phraseEl.style.opacity = 1;
          phraseEl.style.transform = 'translateY(0) scale(1)';
        });
        pickRomanticGradient();
      }
      showPhrase();
      const phraseInt = setInterval(showPhrase, perPhrase*1000);
      const timerInt = setInterval(tick, 1000);
      const cleanup = ()=>{
        clearInterval(phraseInt);
        clearInterval(timerInt);
      };
      window.addEventListener('beforeunload', cleanup, { once:true });
    }

    // Pantalla final: m√∫sica y p√©talos solo con bot√≥n
    function startFinalStage(){
      document.querySelectorAll('.petal').forEach(p=>p.remove());
      const finalSection = $('#final');
      const btnStart = document.createElement('button');
      btnStart.textContent = '¬°Comenzar celebraci√≥n!';
      btnStart.className = 'btn';
      btnStart.style.marginTop = '20px';
      finalSection.querySelector('.center-col').appendChild(btnStart);

      btnStart.addEventListener('click', ()=>{
        stopAll();
        tryPlay(musicFinal);
        spawnPetals(40, false);
        btnStart.remove();
      });
    }

    function spawnPetals(n, loop=true){
      for(let i=0;i<n;i++){
        const p = document.createElement('img');
        const imgSrc = petalImages[Math.floor(Math.random()*petalImages.length)];
        p.src = imgSrc;
        p.className = 'petal';
        const startX = Math.random()*100;
        const drift = (Math.random()*40 - 20);
        const scale = (Math.random()*0.7 + 0.6).toFixed(2);
        const dur = (Math.random()*6 + 8).toFixed(2) + 's';
        const delay = (Math.random()*-10).toFixed(2) + 's';
        p.style.setProperty('--x-start', startX+'vw');
        p.style.setProperty('--x-end', (startX + drift)+'vw');
        p.style.setProperty('--scale', scale);
        p.style.setProperty('--dur', dur);
        p.style.setProperty('--delay', delay);
        if(!loop){
          p.style.animationIterationCount = '1';
        }
        document.body.appendChild(p);
      }
    }
  </script>
</body>
</html>
